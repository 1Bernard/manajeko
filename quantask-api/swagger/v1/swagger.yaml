---
openapi: 3.0.1
info:
  title: Manajeko API V1
  version: v1
servers:
  - url: https://manajeko.onrender.com
    description: Production Server
  - url: http://localhost:3001
    description: Local Development
paths:
  "/api/v1/analytics/dashboard":
    get:
      summary: get dashboard stats
      tags:
        - Analytics
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_tasks:
                    type: integer
                  completed_tasks:
                    type: integer
                  overdue_tasks_count:
                    type: integer
                  tasks_by_status:
                    type: object
                    additionalProperties:
                      type: integer
                  tasks_by_priority:
                    type: object
                    additionalProperties:
                      type: integer
                  completion_trend:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                        count:
                          type: integer
                  upcoming_deadlines:
                    type: array
                    items:
                      type: object
                  recent_activities:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        taskId:
                          type: integer
                        projectId:
                          type: integer
                        action:
                          type: string
                        target:
                          type: string
                        time:
                          type: string
                        user:
                          type: object
                          properties:
                            id:
                              type: integer
                            name:
                              type: string
                            avatar:
                              type: string
                              nullable: true
  "/api/v1/tasks/{task_id}/activities":
    parameters:
      - name: task_id
        in: path
        required: true
        schema:
          type: string
    get:
      summary: list task activities
      tags:
        - Activities
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
  "/api/v1/tasks/{task_id}/attachments":
    parameters:
      - name: task_id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: upload attachment
      tags:
        - Attachments
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
  "/api/v1/attachments/{id}":
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    delete:
      summary: delete attachment
      tags:
        - Attachments
      security:
        - bearer_auth: []
      responses:
        "204":
          description: no content
  "/api/v1/attachments/{id}/download":
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    get:
      summary: download attachment
      tags:
        - Attachments
      security:
        - bearer_auth: []
      responses:
        "302":
          description: found
  "/api/v1/auth/register":
    post:
      summary: register user
      tags:
        - Authentication
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
                password_confirmation:
                  type: string
                first_name:
                  type: string
                  nullable: true
                last_name:
                  type: string
                  nullable: true
                phone_number:
                  type: string
                  nullable: true
                otp_method:
                  type: string
                  enum:
                    - email
                    - sms
                  default: email
              required:
                - email
                - password
                - password_confirmation
  "/api/v1/auth/verify-otp":
    post:
      summary: verify otp
      tags:
        - Authentication
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                otp_code:
                  type: string
              required:
                - email
                - otp_code
  "/api/v1/auth/resend-otp":
    post:
      summary: resend otp
      tags:
        - Authentication
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
              required:
                - email
  "/api/v1/auth/login":
    post:
      summary: login user
      tags:
        - Authentication
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
                - email
                - password
  "/api/v1/auth/me":
    get:
      summary: get current user profile
      tags:
        - Authentication
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
    patch:
      summary: update profile
      tags:
        - Authentication
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                first_name:
                  type: string
                  nullable: true
                last_name:
                  type: string
                  nullable: true
                job_title:
                  type: string
                  nullable: true
                bio:
                  type: string
                  nullable: true
                location:
                  type: string
                  nullable: true
                avatar:
                  type: string
                  nullable: true
  "/api/v1/tasks/{task_id}/comments":
    parameters:
      - name: task_id
        in: path
        required: true
        schema:
          type: string
    get:
      summary: list comments
      tags:
        - Comments
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
    post:
      summary: create comment
      tags:
        - Comments
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
              required:
                - content
  "/api/v1/comments/{id}":
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    delete:
      summary: delete comment
      tags:
        - Comments
      security:
        - bearer_auth: []
      responses:
        "204":
          description: no content
  "/api/v1/notifications":
    get:
      summary: list notifications
      tags:
        - Notifications
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
    patch:
      summary: mark all as read
      tags:
        - Notifications
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
  "/api/v1/notifications/{id}/mark_read":
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    patch:
      summary: mark notification as read
      tags:
        - Notifications
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
  "/api/v1/workspaces/{workspace_id}/projects":
    parameters:
      - name: workspace_id
        in: path
        description: Workspace ID
        required: true
        schema:
          type: string
    get:
      summary: list projects
      tags:
        - Projects
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
    post:
      summary: create project
      tags:
        - Projects
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                visibility:
                  type: string
                  enum:
                    - private
                    - public
                color:
                  type: string
                icon:
                  type: string
                  nullable: true
                banner_image:
                  type: string
                  nullable: true
                status:
                  type: string
              required:
                - name
  "/api/v1/projects/{id}":
    parameters:
      - name: id
        in: path
        description: Project ID
        required: true
        schema:
          type: string
    get:
      summary: show project
      tags:
        - Projects
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
    patch:
      summary: update project
      tags:
        - Projects
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                status:
                  type: string
                color:
                  type: string
                visibility:
                  type: string
                  enum:
                    - private
                    - public
                icon:
                  type: string
                  nullable: true
                banner_image:
                  type: string
                  nullable: true
    delete:
      summary: delete project
      tags:
        - Projects
      security:
        - bearer_auth: []
      responses:
        "204":
          description: no content
  "/api/v1/search":
    get:
      summary: global search
      tags:
        - Search
      security:
        - bearer_auth: []
      parameters:
        - name: q
          in: query
          description: Search term
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful
  "/api/v1/tasks/{task_id}/subtasks":
    parameters:
      - name: task_id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: create subtask
      tags:
        - Subtasks
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                is_completed:
                  type: boolean
              required:
                - title
  "/api/v1/subtasks/{id}":
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    patch:
      summary: update subtask
      tags:
        - Subtasks
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                is_completed:
                  type: boolean
    delete:
      summary: delete subtask
      tags:
        - Subtasks
      security:
        - bearer_auth: []
      responses:
        "204":
          description: no content
  "/api/v1/projects/{project_id}/tags":
    parameters:
      - name: project_id
        in: path
        required: true
        schema:
          type: string
    get:
      summary: list tags
      tags:
        - Tags
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
    post:
      summary: create tag
      tags:
        - Tags
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                color:
                  type: string
              required:
                - name
                - color
  "/api/v1/tags/{id}":
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    patch:
      summary: update tag
      tags:
        - Tags
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                color:
                  type: string
    delete:
      summary: delete tag
      tags:
        - Tags
      security:
        - bearer_auth: []
      responses:
        "204":
          description: no content
  "/api/v1/tasks/{task_id}/tags":
    parameters:
      - name: task_id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: add tag to task
      tags:
        - Tags
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "200":
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                tag_id:
                  type: integer
              required:
                - tag_id
  "/api/v1/tasks/{task_id}/tags/{tag_id}":
    parameters:
      - name: task_id
        in: path
        required: true
        schema:
          type: string
      - name: tag_id
        in: path
        required: true
        schema:
          type: string
    delete:
      summary: remove tag from task
      tags:
        - Tags
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
  "/api/v1/tasks":
    get:
      summary: list tasks
      tags:
        - Tasks
      security:
        - bearer_auth: []
      parameters:
        - name: project_id
          in: query
          description: Filter by Project ID
          required: false
          schema:
            type: string
        - name: q
          in: query
          description: Search term
          required: false
          schema:
            type: string
        - name: status
          in: query
          description: Filter by status
          required: false
          schema:
            type: string
        - name: priority
          in: query
          description: Filter by priority
          required: false
          schema:
            type: string
        - name: task_type
          in: query
          description: Filter by task type
          required: false
          schema:
            type: string
        - name: assignee_id
          in: query
          description: Filter by assignee
          required: false
          schema:
            type: string
        - name: due_date_from
          in: query
          description: Due date from
          required: false
          schema:
            type: string
            format: date
        - name: due_date_to
          in: query
          description: Due date to
          required: false
          schema:
            type: string
            format: date
        - name: sort_by
          in: query
          description: Sort criteria (due_date, priority)
          required: false
          schema:
            type: string
      responses:
        "200":
          description: successful
    post:
      summary: create task
      tags:
        - Tasks
      security:
        - bearer_auth: []
      parameters:
        - name: project_id
          in: query
          description: Project ID
          required: true
          schema:
            type: string
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                description:
                  type: string
                status:
                  type: string
                priority:
                  type: string
                task_type:
                  type: string
                  nullable: true
                due_date:
                  type: string
                  format: date
                  nullable: true
                start_date:
                  type: string
                  format: date
                  nullable: true
                assignee_id:
                  type: string
                  nullable: true
                assignee_ids:
                  type: array
                  items:
                    type: integer
                  nullable: true
                tag_ids:
                  type: array
                  items:
                    type: integer
                  nullable: true
              required:
                - title
                - status
                - priority
  "/api/v1/workspaces/{workspace_id}/invitations":
    parameters:
      - name: workspace_id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: invite member
      tags:
        - Workspace Invitations
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                role:
                  type: string
                  enum:
                    - member
                    - admin
              required:
                - email
  "/api/v1/workspaces":
    get:
      summary: list workspaces
      tags:
        - Workspaces
      security:
        - bearer_auth: []
      responses:
        "200":
          description: successful
    post:
      summary: create workspace
      tags:
        - Workspaces
      security:
        - bearer_auth: []
      parameters: []
      responses:
        "201":
          description: created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                  nullable: true
                logo_url:
                  type: string
                  nullable: true
              required:
                - name
  "/api/v1/workspaces/{id}/members":
    get:
      summary: list workspace members
      tags:
        - Workspaces
      security:
        - bearer_auth: []
      parameters:
        - name: id
          in: path
          description: Workspace ID
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful
components:
  securitySchemes:
    bearer_auth:
      type: http
      scheme: bearer
      bearerFormat: JWT
